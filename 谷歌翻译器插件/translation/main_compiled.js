/* Copyright 2014 Google */ (function(){var h=this,l=function(){},m=function(a){var b=typeof a;if("object"==b)if(a){if(a instanceof Array)return"array";if(a instanceof Object)return b;var c=Object.prototype.toString.call(a);if("[object Window]"==c)return"object";if("[object Array]"==c||"number"==typeof a.length&&"undefined"!=typeof a.splice&&"undefined"!=typeof a.propertyIsEnumerable&&!a.propertyIsEnumerable("splice"))return"array";if("[object Function]"==c||"undefined"!=typeof a.call&&"undefined"!=typeof a.propertyIsEnumerable&&!a.propertyIsEnumerable("call"))return"function"}else return"null";
else if("function"==b&&"undefined"==typeof a.call)return"object";return b},n=function(a){return"function"==m(a)},aa=function(a,b,c){return a.call.apply(a.bind,arguments)},ba=function(a,b,c){if(!a)throw Error();if(2<arguments.length){var d=Array.prototype.slice.call(arguments,2);return function(){var c=Array.prototype.slice.call(arguments);Array.prototype.unshift.apply(c,d);return a.apply(b,c)}}return function(){return a.apply(b,arguments)}},p=function(a,b,c){p=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?
aa:ba;return p.apply(null,arguments)},ca=Date.now||function(){return+new Date},q=function(a,b){function c(){}c.prototype=b.prototype;a.J=b.prototype;a.prototype=new c;a.I=function(a,c,f){for(var g=Array(arguments.length-2),k=2;k<arguments.length;k++)g[k-2]=arguments[k];return b.prototype[c].apply(a,g)}};Function.prototype.bind=Function.prototype.bind||function(a,b){if(1<arguments.length){var c=Array.prototype.slice.call(arguments,1);c.unshift(this,a);return p.apply(null,c)}return p(this,a)};var r=function(a){if(Error.captureStackTrace)Error.captureStackTrace(this,r);else{var b=Error().stack;b&&(this.stack=b)}a&&(this.message=String(a))};q(r,Error);r.prototype.name="CustomError";var da=function(a,b){for(var c=a.split("%s"),d="",e=Array.prototype.slice.call(arguments,1);e.length&&1<c.length;)d+=c.shift()+e.shift();return d+c.join("%s")},ea=String.prototype.trim?function(a){return a.trim()}:function(a){return a.replace(/^[\s\xa0]+|[\s\xa0]+$/g,"")},fa=function(a,b){return a<b?-1:a>b?1:0};var ga=function(a,b){b.unshift(a);r.call(this,da.apply(null,b));b.shift()};q(ga,r);ga.prototype.name="AssertionError";var ha=function(a,b,c,d){var e="Assertion failed";if(c)var e=e+(": "+c),f=d;else a&&(e+=": "+a,f=b);throw new ga(""+e,f||[]);},t=function(a,b,c){a||ha("",null,b,Array.prototype.slice.call(arguments,2))},u=function(a,b,c){n(a)||ha("Expected function but got %s: %s.",[m(a),a],b,Array.prototype.slice.call(arguments,2))};var v=Array.prototype,ia=v.some?function(a,b,c){t(null!=a.length);return v.some.call(a,b,c)}:function(a,b,c){for(var d=a.length,e="string"==typeof a?a.split(""):a,f=0;f<d;f++)if(f in e&&b.call(c,e[f],f,a))return!0;return!1},ja=function(a){return v.concat.apply(v,arguments)},ka=function(a){var b=a.length;if(0<b){for(var c=Array(b),d=0;d<b;d++)c[d]=a[d];return c}return[]};var la="StopIteration"in h?h.StopIteration:{message:"StopIteration",stack:""},ma=function(){};ma.prototype.next=function(){throw la;};ma.prototype.g=function(){return this};var na=function(a,b){for(var c in a)b.call(void 0,a[c],c,a)},oa=function(a){var b=arguments.length;if(1==b&&"array"==m(arguments[0]))return oa.apply(null,arguments[0]);for(var c={},d=0;d<b;d++)c[arguments[d]]=!0;return c};var w=function(a,b){this.b={};this.a=[];this.f=this.c=0;var c=arguments.length;if(1<c){if(c%2)throw Error("Uneven number of arguments");for(var d=0;d<c;d+=2)this.set(arguments[d],arguments[d+1])}else if(a){var e;if(a instanceof w)e=a.s(),d=a.o();else{var c=[],f=0;for(e in a)c[f++]=e;e=c;c=[];f=0;for(d in a)c[f++]=a[d];d=c}for(c=0;c<e.length;c++)this.set(e[c],d[c])}};w.prototype.o=function(){x(this);for(var a=[],b=0;b<this.a.length;b++)a.push(this.b[this.a[b]]);return a};
w.prototype.s=function(){x(this);return this.a.concat()};w.prototype.remove=function(a){return y(this.b,a)?(delete this.b[a],this.c--,this.f++,this.a.length>2*this.c&&x(this),!0):!1};var x=function(a){if(a.c!=a.a.length){for(var b=0,c=0;b<a.a.length;){var d=a.a[b];y(a.b,d)&&(a.a[c++]=d);b++}a.a.length=c}if(a.c!=a.a.length){for(var e={},c=b=0;b<a.a.length;)d=a.a[b],y(e,d)||(a.a[c++]=d,e[d]=1),b++;a.a.length=c}};w.prototype.get=function(a,b){return y(this.b,a)?this.b[a]:b};
w.prototype.set=function(a,b){y(this.b,a)||(this.c++,this.a.push(a),this.f++);this.b[a]=b};w.prototype.forEach=function(a,b){for(var c=this.s(),d=0;d<c.length;d++){var e=c[d],f=this.get(e);a.call(b,f,e,this)}};w.prototype.clone=function(){return new w(this)};w.prototype.g=function(a){x(this);var b=0,c=this.f,d=this,e=new ma;e.next=function(){if(c!=d.f)throw Error("The map has changed since the iterator was created");if(b>=d.a.length)throw la;var e=d.a[b++];return a?e:d.b[e]};return e};
var y=function(a,b){return Object.prototype.hasOwnProperty.call(a,b)};var z;a:{var pa=h.navigator;if(pa){var qa=pa.userAgent;if(qa){z=qa;break a}}z=""};var ra=function(){return-1!=z.indexOf("Edge")||-1!=z.indexOf("Trident")||-1!=z.indexOf("MSIE")};var A=function(){return-1!=z.indexOf("Edge")};var sa=-1!=z.indexOf("Opera")||-1!=z.indexOf("OPR"),B=ra(),ta=-1!=z.indexOf("Gecko")&&!(-1!=z.toLowerCase().indexOf("webkit")&&!A())&&!(-1!=z.indexOf("Trident")||-1!=z.indexOf("MSIE"))&&!A(),ua=-1!=z.toLowerCase().indexOf("webkit")&&!A(),va=function(){var a=z;if(ta)return/rv\:([^\);]+)(\)|;)/.exec(a);if(B&&A())return/Edge\/([\d\.]+)/.exec(a);if(B)return/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(a);if(ua)return/WebKit\/(\S+)/.exec(a)},wa=function(){var a=h.document;return a?a.documentMode:void 0},xa=
function(){if(sa&&h.opera){var a=h.opera.version;return n(a)?a():a}var a="",b=va();b&&(a=b?b[1]:"");return B&&!A()&&(b=wa(),b>parseFloat(a))?String(b):a}(),ya={},za=function(a){if(!ya[a]){for(var b=0,c=ea(String(xa)).split("."),d=ea(String(a)).split("."),e=Math.max(c.length,d.length),f=0;0==b&&f<e;f++){var g=c[f]||"",k=d[f]||"",F=RegExp("(\\d*)(\\D*)","g"),J=RegExp("(\\d*)(\\D*)","g");do{var K=F.exec(g)||["","",""],L=J.exec(k)||["","",""];if(0==K[0].length&&0==L[0].length)break;b=fa(0==K[1].length?
0:parseInt(K[1],10),0==L[1].length?0:parseInt(L[1],10))||fa(0==K[2].length,0==L[2].length)||fa(K[2],L[2])}while(0==b)}ya[a]=0<=b}},Aa=h.document,Ba=wa(),Ca=!Aa||!B||!Ba&&A()?void 0:Ba||("CSS1Compat"==Aa.compatMode?parseInt(xa,10):5);var Da=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^/?#]*)@)?([^/#?]*?)(?::([0-9]+))?(?=[/#?]|$))?([^?#]+)?(?:\?([^#]*))?(?:#(.*))?$/,Fa=function(a){if(Ea){Ea=!1;var b=h.location;if(b){var c=b.href;if(c&&(c=(c=Fa(c)[3]||null)?decodeURI(c):c)&&c!=b.hostname)throw Ea=!0,Error();}}return a.match(Da)},Ea=ua,Ga=function(a,b){for(var c=a.split("&"),d=0;d<c.length;d++){var e=c[d].indexOf("="),f=null,g=null;0<=e?(f=c[d].substring(0,e),g=c[d].substring(e+1)):f=c[d];b(f,g?decodeURIComponent(g.replace(/\+/g," ")):"")}};var C=function(a,b){this.f=this.j=this.c="";this.i=null;this.g=this.h="";this.a=!1;var c;a instanceof C?(this.a=void 0!==b?b:a.a,Ha(this,a.c),this.j=a.j,this.f=a.f,Ia(this,a.i),this.h=a.h,Ja(this,a.b.clone()),this.g=a.g):a&&(c=Fa(String(a)))?(this.a=!!b,Ha(this,c[1]||"",!0),this.j=D(c[2]||""),this.f=D(c[3]||"",!0),Ia(this,c[4]),this.h=D(c[5]||"",!0),Ja(this,c[6]||"",!0),this.g=D(c[7]||"")):(this.a=!!b,this.b=new E(null,0,this.a))};
C.prototype.toString=function(){var a=[],b=this.c;b&&a.push(G(b,Ka,!0),":");if(b=this.f){a.push("//");var c=this.j;c&&a.push(G(c,Ka,!0),"@");a.push(encodeURIComponent(String(b)).replace(/%25([0-9a-fA-F]{2})/g,"%$1"));b=this.i;null!=b&&a.push(":",String(b))}if(b=this.h)this.f&&"/"!=b.charAt(0)&&a.push("/"),a.push(G(b,"/"==b.charAt(0)?La:Ma,!0));(b=this.b.toString())&&a.push("?",b);(b=this.g)&&a.push("#",G(b,Na));return a.join("")};C.prototype.clone=function(){return new C(this)};
var Ha=function(a,b,c){a.c=c?D(b,!0):b;a.c&&(a.c=a.c.replace(/:$/,""))},Ia=function(a,b){if(b){b=Number(b);if(isNaN(b)||0>b)throw Error("Bad port number "+b);a.i=b}else a.i=null},Ja=function(a,b,c){b instanceof E?(a.b=b,Oa(a.b,a.a)):(c||(b=G(b,Pa)),a.b=new E(b,0,a.a))},Ra=function(a,b,c){"array"==m(c)||(c=[String(c)]);Qa(a.b,b,c)},D=function(a,b){return a?b?decodeURI(a):decodeURIComponent(a):""},G=function(a,b,c){return"string"==typeof a?(a=encodeURI(a).replace(b,Sa),c&&(a=a.replace(/%25([0-9a-fA-F]{2})/g,
"%$1")),a):null},Sa=function(a){a=a.charCodeAt(0);return"%"+(a>>4&15).toString(16)+(a&15).toString(16)},Ka=/[#\/\?@]/g,Ma=/[\#\?:]/g,La=/[\#\?]/g,Pa=/[\#\?@]/g,Na=/#/g,E=function(a,b,c){this.c=this.a=null;this.b=a||null;this.f=!!c},H=function(a){a.a||(a.a=new w,a.c=0,a.b&&Ga(a.b,function(b,c){var d=decodeURIComponent(b.replace(/\+/g," "));H(a);a.b=null;var d=I(a,d),e=a.a.get(d);e||a.a.set(d,e=[]);e.push(c);a.c++}))};
E.prototype.remove=function(a){H(this);a=I(this,a);return y(this.a.b,a)?(this.b=null,this.c-=this.a.get(a).length,this.a.remove(a)):!1};var Ta=function(a,b){H(a);b=I(a,b);return y(a.a.b,b)};E.prototype.s=function(){H(this);for(var a=this.a.o(),b=this.a.s(),c=[],d=0;d<b.length;d++)for(var e=a[d],f=0;f<e.length;f++)c.push(b[d]);return c};E.prototype.o=function(a){H(this);var b=[];if("string"==typeof a)Ta(this,a)&&(b=ja(b,this.a.get(I(this,a))));else{a=this.a.o();for(var c=0;c<a.length;c++)b=ja(b,a[c])}return b};
E.prototype.set=function(a,b){H(this);this.b=null;a=I(this,a);Ta(this,a)&&(this.c-=this.a.get(a).length);this.a.set(a,[b]);this.c++;return this};E.prototype.get=function(a,b){var c=a?this.o(a):[];return 0<c.length?String(c[0]):b};var Qa=function(a,b,c){a.remove(b);0<c.length&&(a.b=null,a.a.set(I(a,b),ka(c)),a.c+=c.length)};
E.prototype.toString=function(){if(this.b)return this.b;if(!this.a)return"";for(var a=[],b=this.a.s(),c=0;c<b.length;c++)for(var d=b[c],e=encodeURIComponent(String(d)),d=this.o(d),f=0;f<d.length;f++){var g=e;""!==d[f]&&(g+="="+encodeURIComponent(String(d[f])));a.push(g)}return this.b=a.join("&")};E.prototype.clone=function(){var a=new E;a.b=this.b;this.a&&(a.a=this.a.clone(),a.c=this.c);return a};
var I=function(a,b){var c=String(b);a.f&&(c=c.toLowerCase());return c},Oa=function(a,b){b&&!a.f&&(H(a),a.b=null,a.a.forEach(function(a,b){var e=b.toLowerCase();b!=e&&(this.remove(b),Qa(this,e,a))},a));a.f=b};oa("area base br col command embed hr img input keygen link meta param source track wbr".split(" "));var Ua;if(!(Ua=!ta&&!B)){var Va;if(Va=B)Va=B&&(A()||9<=Ca);Ua=Va}Ua||ta&&za("1.9.1");B&&za("9");var Xa=function(a,b){na(b,function(b,d){"style"==d?a.style.cssText=b:"class"==d?a.className=b:"for"==d?a.htmlFor=b:d in Wa?a.setAttribute(Wa[d],b):0==d.lastIndexOf("aria-",0)||0==d.lastIndexOf("data-",0)?a.setAttribute(d,b):a[d]=b})},Wa={cellpadding:"cellPadding",cellspacing:"cellSpacing",colspan:"colSpan",frameborder:"frameBorder",height:"height",maxlength:"maxLength",role:"role",rowspan:"rowSpan",type:"type",usemap:"useMap",valign:"vAlign",width:"width"};var Ya=function(a,b,c){this.f=c;this.c=a;this.g=b;this.b=0;this.a=null};Ya.prototype.get=function(){var a;0<this.b?(this.b--,a=this.a,this.a=a.next,a.next=null):a=this.c();return a};var Za=function(a,b){a.g(b);a.b<a.f&&(a.b++,b.next=a.a,a.a=b)};var $a=function(a){h.setTimeout(function(){throw a;},0)},ab,bb=function(){var a=h.MessageChannel;"undefined"===typeof a&&"undefined"!==typeof window&&window.postMessage&&window.addEventListener&&-1==z.indexOf("Presto")&&(a=function(){var a=document.createElement("IFRAME");a.style.display="none";a.src="";document.documentElement.appendChild(a);var b=a.contentWindow,a=b.document;a.open();a.write("");a.close();var c="callImmediate"+Math.random(),d="file:"==b.location.protocol?"*":b.location.protocol+
"//"+b.location.host,a=p(function(a){if(("*"==d||a.origin==d)&&a.data==c)this.port1.onmessage()},this);b.addEventListener("message",a,!1);this.port1={};this.port2={postMessage:function(){b.postMessage(c,d)}}});if("undefined"!==typeof a&&!ra()){var b=new a,c={},d=c;b.port1.onmessage=function(){if(void 0!==c.next){c=c.next;var a=c.A;c.A=null;a()}};return function(a){d.next={A:a};d=d.next;b.port2.postMessage(0)}}return"undefined"!==typeof document&&"onreadystatechange"in document.createElement("SCRIPT")?
function(a){var b=document.createElement("SCRIPT");b.onreadystatechange=function(){b.onreadystatechange=null;b.parentNode.removeChild(b);b=null;a();a=null};document.documentElement.appendChild(b)}:function(a){h.setTimeout(a,0)}};var cb=function(){this.b=this.a=null},eb=new Ya(function(){return new db},function(a){a.reset()},100);cb.prototype.remove=function(){var a=null;this.a&&(a=this.a,this.a=this.a.next,this.a||(this.b=null),a.next=null);return a};var db=function(){this.next=this.b=this.a=null};db.prototype.set=function(a,b){this.a=a;this.b=b;this.next=null};db.prototype.reset=function(){this.next=this.b=this.a=null};var ib=function(a,b){M||fb();gb||(M(),gb=!0);var c=hb,d=eb.get();d.set(a,b);c.b?c.b.next=d:(t(!c.a),c.a=d);c.b=d},M,fb=function(){if(h.Promise&&h.Promise.resolve){var a=h.Promise.resolve();M=function(){a.then(jb)}}else M=function(){var a=jb;!n(h.setImmediate)||h.Window&&h.Window.prototype&&h.Window.prototype.setImmediate==h.setImmediate?(ab||(ab=bb()),ab(a)):h.setImmediate(a)}},gb=!1,hb=new cb,jb=function(){for(var a=null;a=hb.remove();){try{a.a.call(a.b)}catch(b){$a(b)}Za(eb,a)}gb=!1};var kb=function(a){a.prototype.then=a.prototype.then;a.prototype.$goog_Thenable=!0},lb=function(a){if(!a)return!1;try{return!!a.$goog_Thenable}catch(b){return!1}};var P=function(a,b){this.a=0;this.i=void 0;this.f=this.b=this.c=null;this.g=this.h=!1;if(a==mb)N(this,2,b);else try{var c=this;a.call(b,function(a){N(c,2,a)},function(a){if(!(a instanceof O))try{if(a instanceof Error)throw a;throw Error("Promise rejected.");}catch(b){}N(c,3,a)})}catch(d){N(this,3,d)}},nb=function(){this.next=this.f=this.c=this.b=this.a=null;this.g=!1};nb.prototype.reset=function(){this.f=this.c=this.b=this.a=null;this.g=!1};
var ob=new Ya(function(){return new nb},function(a){a.reset()},100),pb=function(a,b,c){var d=ob.get();d.b=a;d.c=b;d.f=c;return d},mb=function(){};P.prototype.then=function(a,b,c){null!=a&&u(a,"opt_onFulfilled should be a function.");null!=b&&u(b,"opt_onRejected should be a function. Did you pass opt_context as the second argument instead of the third?");return qb(this,n(a)?a:null,n(b)?b:null,c)};kb(P);P.prototype.cancel=function(a){0==this.a&&ib(function(){var b=new O(a);rb(this,b)},this)};
var rb=function(a,b){if(0==a.a)if(a.c){var c=a.c;if(c.b){for(var d=0,e=null,f=null,g=c.b;g&&(g.g||(d++,g.a==a&&(e=g),!(e&&1<d)));g=g.next)e||(f=g);e&&(0==c.a&&1==d?rb(c,b):(f?(d=f,t(c.b),t(null!=d),d.next==c.f&&(c.f=d),d.next=d.next.next):sb(c),tb(c,e,3,b)))}a.c=null}else N(a,3,b)},vb=function(a,b){a.b||2!=a.a&&3!=a.a||ub(a);t(null!=b.b);a.f?a.f.next=b:a.b=b;a.f=b},qb=function(a,b,c,d){var e=pb(null,null,null);e.a=new P(function(a,g){e.b=b?function(c){try{var e=b.call(d,c);a(e)}catch(J){g(J)}}:a;
e.c=c?function(b){try{var e=c.call(d,b);void 0===e&&b instanceof O?g(b):a(e)}catch(J){g(J)}}:g});e.a.c=a;vb(a,e);return e.a};P.prototype.j=function(a){t(1==this.a);this.a=0;N(this,2,a)};P.prototype.m=function(a){t(1==this.a);this.a=0;N(this,3,a)};
var N=function(a,b,c){if(0==a.a){if(a==c)b=3,c=new TypeError("Promise cannot resolve to itself");else{if(lb(c)){a.a=1;b=c;c=a.j;var d=a.m;b instanceof P?(null!=c&&u(c,"opt_onFulfilled should be a function."),null!=d&&u(d,"opt_onRejected should be a function. Did you pass opt_context as the second argument instead of the third?"),vb(b,pb(c||l,d||null,a))):b.then(c,d,a);return}d=typeof c;if("object"==d&&null!=c||"function"==d)try{var e=c.then;if(n(e)){wb(a,c,e);return}}catch(f){b=3,c=f}}a.i=c;a.a=b;
a.c=null;ub(a);3!=b||c instanceof O||xb(a,c)}},wb=function(a,b,c){a.a=1;var d=!1,e=function(b){d||(d=!0,a.j(b))},f=function(b){d||(d=!0,a.m(b))};try{c.call(b,e,f)}catch(g){f(g)}},ub=function(a){a.h||(a.h=!0,ib(a.u,a))},sb=function(a){var b=null;a.b&&(b=a.b,a.b=b.next,b.next=null);a.b||(a.f=null);null!=b&&t(null!=b.b);return b};P.prototype.u=function(){for(var a=null;a=sb(this);)tb(this,a,this.a,this.i);this.h=!1};
var tb=function(a,b,c,d){if(3==c&&b.c&&!b.g)for(;a&&a.g;a=a.c)a.g=!1;if(b.a)b.a.c=null,yb(b,c,d);else try{b.g?b.b.call(b.f):yb(b,c,d)}catch(e){zb.call(null,e)}Za(ob,b)},yb=function(a,b,c){2==b?a.b.call(a.f,c):a.c&&a.c.call(a.f,c)},xb=function(a,b){a.g=!0;ib(function(){a.g&&zb.call(null,b)})},zb=$a,O=function(a){r.call(this,a)};q(O,r);O.prototype.name="cancel";/*
 Portions of this code are from MochiKit, received by
 The Closure Authors under the MIT license. All other code is Copyright
 2005-2009 The Closure Authors. All Rights Reserved.
*/
var Q=function(a,b){this.g=[];this.G=a;this.D=b||null;this.f=this.a=!1;this.c=void 0;this.m=this.u=this.i=!1;this.h=0;this.b=null;this.j=0};Q.prototype.cancel=function(a){if(this.a)this.c instanceof Q&&this.c.cancel();else{if(this.b){var b=this.b;delete this.b;a?b.cancel(a):(b.j--,0>=b.j&&b.cancel())}this.G?this.G.call(this.D,this):this.m=!0;this.a||Ab(this,new R)}};Q.prototype.C=function(a,b){this.i=!1;Bb(this,a,b)};
var Bb=function(a,b,c){a.a=!0;a.c=c;a.f=!b;Cb(a)},Eb=function(a){if(a.a){if(!a.m)throw new Db;a.m=!1}},Ab=function(a,b){Eb(a);Fb(b);Bb(a,!1,b)},Fb=function(a){t(!(a instanceof Q),"An execution sequence may not be initiated with a blocking Deferred.")},Gb=function(a,b,c,d){t(!a.u,"Blocking Deferreds can not be re-used");a.g.push([b,c,d]);a.a&&Cb(a)};Q.prototype.then=function(a,b,c){var d,e,f=new P(function(a,b){d=a;e=b});Gb(this,d,function(a){a instanceof R?f.cancel():e(a)});return f.then(a,b,c)};
kb(Q);
var Hb=function(a){return ia(a.g,function(a){return n(a[1])})},Cb=function(a){if(a.h&&a.a&&Hb(a)){var b=a.h,c=S[b];c&&(h.clearTimeout(c.l),delete S[b]);a.h=0}a.b&&(a.b.j--,delete a.b);for(var b=a.c,d=c=!1;a.g.length&&!a.i;){var e=a.g.shift(),f=e[0],g=e[1],e=e[2];if(f=a.f?g:f)try{var k=f.call(e||a.D,b);void 0!==k&&(a.f=a.f&&(k==b||k instanceof Error),a.c=b=k);if(lb(b)||"function"===typeof h.Promise&&b instanceof h.Promise)d=!0,a.i=!0}catch(F){b=F,a.f=!0,Hb(a)||(c=!0)}}a.c=b;d&&(k=p(a.C,a,!0),d=p(a.C,
a,!1),b instanceof Q?(Gb(b,k,d),b.u=!0):b.then(k,d));c&&(b=new Ib(b),S[b.l]=b,a.h=b.l)},Db=function(){r.call(this)};q(Db,r);Db.prototype.message="Deferred has already fired";Db.prototype.name="AlreadyCalledError";var R=function(){r.call(this)};q(R,r);R.prototype.message="Deferred was canceled";R.prototype.name="CanceledError";var Ib=function(a){this.l=h.setTimeout(p(this.b,this),0);this.a=a};
Ib.prototype.b=function(){t(S[this.l],"Cannot throw an error that is not scheduled.");delete S[this.l];throw this.a;};var S={};var Nb=function(a,b){var c=b||{},d=c.document||document,e=document.createElement("SCRIPT"),f={F:e,v:void 0},g=new Q(Jb,f),k=null,F=null!=c.timeout?c.timeout:5E3;0<F&&(k=window.setTimeout(function(){Kb(e,!0);Ab(g,new Lb(1,"Timeout reached for loading script "+a))},F),f.v=k);e.onload=e.onreadystatechange=function(){e.readyState&&"loaded"!=e.readyState&&"complete"!=e.readyState||(Kb(e,c.H||!1,k),Eb(g),Fb(null),Bb(g,!0,null))};e.onerror=function(){Kb(e,!0,k);Ab(g,new Lb(0,"Error while loading script "+
a))};Xa(e,{type:"text/javascript",charset:"UTF-8",src:a});Mb(d).appendChild(e);return g},Mb=function(a){var b=a.getElementsByTagName("HEAD");return b&&0!=b.length?b[0]:a.documentElement},Jb=function(){if(this&&this.F){var a=this.F;a&&"SCRIPT"==a.tagName&&Kb(a,!0,this.v)}},Kb=function(a,b,c){null!=c&&h.clearTimeout(c);a.onload=l;a.onerror=l;a.onreadystatechange=l;b&&window.setTimeout(function(){a&&a.parentNode&&a.parentNode.removeChild(a)},0)},Lb=function(a,b){var c="Jsloader error (code #"+a+")";
b&&(c+=": "+b);r.call(this,c);this.code=a};q(Lb,r);var Ob=function(a,b){this.b=new C(a);this.a=b?b:"callback";this.v=5E3},Pb=0;Ob.prototype.send=function(a,b,c,d){a=a||null;d=d||"_"+(Pb++).toString(36)+ca().toString(36);h._callbacks_||(h._callbacks_={});var e=this.b.clone();if(a)for(var f in a)a.hasOwnProperty&&!a.hasOwnProperty(f)||Ra(e,f,a[f]);b&&(h._callbacks_[d]=Qb(d,b),Ra(e,this.a,"_callbacks_."+d));b=Nb(e.toString(),{timeout:this.v,H:!0});Gb(b,null,Rb(d,a,c),void 0);return{l:d,B:b}};
Ob.prototype.cancel=function(a){a&&(a.B&&a.B.cancel(),a.l&&Sb(a.l,!1))};var Rb=function(a,b,c){return function(){Sb(a,!1);c&&c(b)}},Qb=function(a,b){return function(c){Sb(a,!0);b.apply(void 0,arguments)}},Sb=function(a,b){h._callbacks_[a]&&(b?delete h._callbacks_[a]:h._callbacks_[a]=l)};var Tb=function(a,b){return a.replace(/\{\{\$.*?\}\}/g,function(a){a=a.substr(3,a.length-5);return String(b[a])||""})},Ub=function(a){return a.replace(/\\/g,"\\\\").replace(/'/g,"\\'").replace(/"/g,'\\"').replace(/\n/g,"\\n")},Vb=function(a){a=String(a).toLowerCase().replace("_","-");if("zh-cn"==a)return"zh-CN";if("zh-tw"==a)return"zh-TW";var b=a.indexOf("-");a=0<=b?a.substring(0,b):a;return"zh"==a?"zh-CN":a},Wb=function(a,b){return"https://translate.google.com/?source=gtx_c#auto/"+a+"/"+encodeURIComponent(b)};var T=function(a){this.b=[];chrome.i18n.getAcceptLanguages(p(this.i,this));this.a="";this.f="1";this.c=[];this.h=!!a;chrome.storage.local.get(null,p(this.m,this));Xb(this)};
T.prototype.m=function(a){"gtxTargetLang"in a&&(this.a=a.gtxTargetLang);"gtxShowBubble"in a&&(this.f=a.gtxShowBubble);"gtxSourceLangList"in a&&Yb(this,a.gtxSourceLangList);"gtxTargetLangList"in a&&(this.c=Yb(this,a.gtxTargetLangList));this.loaded=!0;if(this.h){var b=(new Date).getTime(),c="gtxTimeStamp"in a?a.gtxTimeStamp:0,d=chrome.i18n.getUILanguage?chrome.i18n.getUILanguage():"en";a="gtxDisplayLanguage"in a?a.gtxDisplayLanguage:"";(864E5<Math.abs(b-c)||d!=a)&&(new Ob("https://translate.googleapis.com/translate_a/l",
"cb")).send({client:"gtx",hl:d},p(this.j,this,d))}};var Yb=function(a,b){var c=[],d;for(d in b)c.push({code:d,name:b[d]});c.sort(a.g);d={};for(var e=0;e<c.length;e++)d[c[e].code]=c[e].name;return d};T.prototype.g=function(a,b){return a.name.localeCompare(b.name)};var Xb=function(a){chrome.storage.onChanged.addListener(function(b){b.gtxTargetLang&&(a.a=b.gtxTargetLang.newValue);b.gtxShowBubble&&(a.f=b.gtxShowBubble.newValue)})};T.prototype.i=function(a){this.b=a};
var Zb=function(){for(var a=U,b=0;b<a.b.length;b++){var c=Vb(a.b[b]);if(a.c[c])return c}return"en"};T.prototype.j=function(a,b){var c=(new Date).getTime(),d={};d.gtxSourceLangList=b.sl;d.gtxTargetLangList=b.tl;d.gtxDisplayLanguage=a;d.gtxTimeStamp=c;chrome.storage.local.set(d);this.c=b.tl};var $b=Tb("(function(){({{$code}})();})();",{code:window.injection.toString()}),ac=Tb("(function(){({{$code}})();})();",{code:window.injector.toString()});delete window.injector;delete window.injection;function bc(a,b,c){b={pageLang:b,userLang:c};b.content=Ub(Tb($b,b));chrome.tabs.executeScript(a,{code:Tb(ac,b)},function(){chrome.runtime.lastError&&console.error(chrome.runtime.lastError.message)})}var cc=function(a){this.c=a;this.w=this.a=!1};
cc.prototype.popup=function(){this.a||this.w||(this.a=!0,this.b="",chrome.tabs.detectLanguage(this.c,p(this.f,this)))};cc.prototype.f=function(a){if(!this.w){if(!a||"und"==a||a.match("invalid"))a="auto";this.b=a;a=""!=U.a?U.a:Zb();a=Vb(a);var b=Vb(this.b);bc(this.c,b,a);this.a=!1}};var V=function(){this.a={}};V.prototype.b=function(a){this.a[a]||(this.a[a]=new cc(a));this.a[a].popup()};V.prototype.c=function(a){this.a[a]&&(this.a[a].w=!0,delete this.a[a])};var dc=new V,U=new T(!0),W=document.createElement("audio");
chrome.runtime.onMessage.addListener(function(a,b){a.audioSrc?W.paused||a.audioSrc!=W.src?(W.src=a.audioSrc,W.load(),W.play()):(W.pause(),W.currentTime=0):a.bubbleClosed||a.popupClosed?W.pause():a.detectLanguage&&chrome.tabs.detectLanguage(function(a){chrome.tabs.sendMessage(b.tab.id,{"gtx.detected":a})})});chrome.runtime.onConnect.addListener(function(a){a.onDisconnect.addListener(function(){chrome.runtime.sendMessage({popupClosed:!0})})});
chrome.contextMenus.create({id:"translate",title:function(a){a=chrome.i18n.getMessage(a);return chrome.i18n.getMessage(a)}("MSG_FOOTER_TRANSLATE"),contexts:["selection"]});chrome.contextMenus.onClicked.addListener(function(a){chrome.tabs.create({url:Wb(""!=U.a?U.a:Zb(),a.selectionText)})});var ec=function(){return dc},X=["translate","getTranslateManager"],Y=h;X[0]in Y||!Y.execScript||Y.execScript("var "+X[0]);for(var Z;X.length&&(Z=X.shift());)X.length||void 0===ec?Y[Z]?Y=Y[Z]:Y=Y[Z]={}:Y[Z]=ec;
V.prototype.attach=V.prototype.b;V.prototype.detach=V.prototype.c;})();
